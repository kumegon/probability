\documentclass[a4j,11pt]{jarticle}
\usepackage{url}
\usepackage[dvipdfmx]{graphicx}
\usepackage{here}
\usepackage{amssymb}
\usepackage{amsmath,amssymb}
\usepackage[dvipdfmx]{hyperref}
\usepackage{enumerate}
\usepackage{mathtools}
\graphicspath{{picture/}}
\usepackage{ascmac}
\usepackage{bm}
\usepackage{amsthm}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{comment}

\setlength{\textwidth}{1.1\textwidth}
\setlength{\oddsidemargin}{-3pt}
\setlength{\evensidemargin}{\oddsidemargin}
\setlength{\topmargin}{-10mm}
\setlength{\headheight}{0mm}
\setlength{\headsep}{0mm}
\begin{comment}
\usepackage{listings,jlisting}
\lstset{language=c,
  basicstyle=\ttfamily\scriptsize,
  commentstyle=\textit,
  classoffset=1,
  keywordstyle=\emphseries,
  frame=tRBl,
  framesep=5pt,
  showstringspaces=false,
  numbers=left,
  stepnumber=1,
  numberstyle=\tiny,
  tabsize=2
}
\end{comment}

\renewcommand\thefootnote{\arabic{footnote})}

\theoremstyle{definition}
\renewcommand{\proofname}{\bf{証明}}
\newtheorem{theorem}{定理}
\newtheorem*{theorem*}{定理}
\newtheorem{definition}[theorem]{定義}
\newtheorem*{definition*}{定義}
\newtheorem{lemma}[theorem]{補題}
\newtheorem*{lemma*}{補題}
\newtheorem{corollary}[theorem]{系}
\newtheorem*{corollary*}{系}
\newtheorem{proposition}[theorem]{命題}
\newtheorem*{proposition*}{命題}
\newtheorem{nature}[theorem]{性質}
\newtheorem{remark}[theorem]{注意}

\newcommand{\argmax}{\mathop{\rm arg~max}\limits}
\newcommand{\argmin}{\mathop{\rm arg~min}\limits}
\newcommand{\DtoR}[2]{{#1 \rightarrow #2}}
\newcommand{\dtor}[2]{{#1 \mapsto #2}}
\newcommand{\prox}[1]{{{\rm prox}_{#1}}}
\newcommand{\inprod}[2]{{\langle #1,#2 \rangle}}

\makeatother
\setcounter{secnumdepth}{4}


\title{舟木確率論ゼミ}
\author{M1 久米啓太}
\date{\today}


\begin{document}
\maketitle

\section*{命題2.25の証明の補足}
1)-3)を満たす
$\mathbb{R}$
上の関数
$F$
が与えられた時, (2.2)を満たすような
$(\mathbb{R},\mathcal{B}(\mathbb{R}))$
上の確率測度
$\mu$
が一意的に定まることの証明をする.\ 

$Y(w):\left( 0,1\right)\to \mathbb{R}:w\mapsto \sup \left\{y \in \mathbb{R} | F(y) < w \right\}, \ w \in \left(0,1 \right)$
とする.
集合
$A$
に対する
$y^\star = \sup A$
は以下を満たす
$\mathbb{R}$
の元である.\ 
\begin{itemize}
  \item 
    任意の
    $y \in A$
    に対して,\ 
    $y \leq y^\star$.
  \item
    任意の
    $\epsilon > 0$
    に対して,\ ある
    $y \in A$
    が存在して,\ 
    $y^\star - \epsilon < y$.
\end{itemize}
教科書では
\begin{quote}
$Y$
は
$F$
の左連続な逆関数
\end{quote}
であると書かれているが,\ 
$F$
に逆関数が存在するとは限らないことに注意する.\ 
なぜならば,\ 1)-3)の条件だけでは
$F$
が全単射であることを保証できないからである.\ 
$F$
が全単射であるためには,\ 狭義単調増加,\ 連続であればよい.\ 
$Y$
が左連続であるかは確かめることができなかった.\ 

\paragraph*{}
任意の
$x\in \mathbb{R}$
に対し,\ 
$\left\{ w \in \left( 0,1\right) | Y(w) \leq x \right\} = \left\{ w\in \left( 0,1\right) | w\leq F(x) \right\}$
が成り立つことを示す.\ 
左辺を
$A(x)$
右辺を
$B(x)$
と書くことにする.\ 

まず,\ 
$A(x) \subset B(x)$
を示す.\ 
$w \in A(x)$
とする.\ 
ここで,\ 
$w > F(x)$
であると仮定する.\ 
$F$
の右連続性から,\ ある
$\delta > 0$
に対して,\ 
$w > F(x + \delta)$
となる.\ 
よって,\ 
$Y(w) \geq x + \delta > x$
となる.\ 
これは
$w \in A(x)$
,\ つまり
$Y(w) \leq x$
であることに矛盾するので,\ 
$w \leq F(x)$
である.\ 
以上より,\ 
$w \in B(x)$,\ 
$A(x) \subset B(x)$.\ 

次に,\ 
$A(x) \supset B(x)$
を示す.\ 
$w \in B(x)$
とすると,\ 
$w \leq F(x)$
である.\ 
$x \not\in \left\{ y \in \mathbb{R} | F(y) < w\right\}$
より,\ 
$Y(w) \leq x$
である.\ 
以上より,\ 
$w \in A(x),\ $
$A(x) \supset B(x)$.\ 

\begin{equation}
  B(x) = \left\{ w  \in\left( 0,1\right) | w \leq F(x)\right\} = 
  \begin{cases}
    \left( 0, F(x)\right] & {\rm if } \ F(x) > 0 \\
    \emptyset & {\rm otherwise}
  \end{cases}
\end{equation}
なので,\ 明らかに
$B(x) \in \mathcal{B}((0,1))$
である.\ 
よって,\ 任意の
$x\in \mathbb{R}$
において
$A(x)$
も可測集合であるので,\ 命題2.15より
$Y$
は確率変数である.\ 


\section*{表記法}
  $(\Omega,\mathcal{F},\mu)$
  を測度空間とし,\ 
  $f:\Omega \to \mathbb{R}$
  を可測関数とする.\ 

  $f = \sum_{i=1}^m a_i 1_{A_i},\ a_i \in \left[ 0, \infty\right],\ A_i \in \mathcal{F}$
  と有限和でかけるとき,\ 
  $f$
  を単純と呼び,\ そのときに限り,\ 
  $f \in SF^+$
  と書く.\ 
  $f$
  が非負値関数であるときに限り,\ 
  $f \in m\mathcal{F}^+$
  と書く.\ 
  $f$
  が一般の可測関数であるときに限り,\ 
  $f \in m\mathcal{F}$
  と書く.\ 

  集合列
  $A_n$
  が単調増加し,\ 
  $\bigcup_{n=1}^{\infty} A_n = A$
  となるとき,\ 
  $A_n \nearrow A$
  と書く.\ 

  また,\ 関数列
  $f_n$
  が各点で単調増加
  $(f_n(\omega) \leq f_{n+1}(\omega) \ldots)$
  し,\ 
  $\lim_{n} f_n(\omega) = f(\omega)$
  となるとき,\ 
  $f_n \nearrow f$
  と書く.\ 

\section*{積分の基礎事項}
\begin{definition}[測度の積分]
  $(\Omega,\mathcal{F},\mu)$
  を測度空間とする.\ 
  $f:\Omega \to \mathbb{R}$
  を可測関数とすると,\ 
  $f$
  の
  $\Omega$
  上の積分を
  $\mu (f)$
  または,\ 
  $\int_{\Omega} f(\omega) \mu (d\omega)$
  と表記する.\ 

  $f \in SF^+$
  のとき,\ 
  \begin{equation}
    \mu (f) := \sum_{i=1}^m a_i \mu(A_i)
  \end{equation}
  と定義しする.\  
  $f \in m\mathcal{F}^+$
  のとき,\ 
  \begin{equation}
    \mu(f) := \sup\left\{ \mu(h) | h \in SF^+,\ h \leq f\right\}
  \end{equation}
  と定義する(教科書とは異なることに注意).\ 
  また,\ 
  $f\in m\mathcal{F}$
  であるとき,\ 
  $f^+(\omega) := \max(f(\omega),0)$,\ 
  $f^-(\omega) := \max(-f(\omega),0)$
  とし,\ さらに
  $\mu(f^+)\, \mu(f^-)$
  のうち少なくとも片方が有限な値を取るとき,\ 
  \begin{equation}
    \mu(f) := \mu(f^+) - \mu(f^-)
  \end{equation}
  と定義する.\ 
\end{definition}

\begin{lemma}[単純な関数の積分の性質]\label{lemma:int_nature}
  $f,\ g \in SF^+$
  とする.\ 
  \begin{description}
    \item[(1)線型性]
      $\alpha,\ \beta \in \mathbb{R}$のとき,\ 
      $\mu(\alpha f + \beta g) = \alpha \mu(f) + \beta \mu(g)$
      となる.\ 
    \item[(2)単調性]
      $f \leq g$
      のとき,\ 
      $\mu(f) \leq \mu(g)$
      となる.\ 
  \end{description}
\end{lemma}

\begin{proof}
  $f = \sum_{i=1}^n a_i 1_{A_i}$, 
  $g = \sum_{j=1}^m b_j 1_{B_j}$
  とする.\ 
  $a_i,\ b_j \in \left[ 0, \infty\right]$,\ 
  $A_i,\ B_j$は各々異なる添字同士で互いに素である.\ 
  $C_{ij} = A_i \cap B_j$
  とすると,\ 
  $C_{ij}$
  も異なる
  $i,\ j$
  同士で互いに素である.\ 

  (1)
  \begin{align}
    \alpha f + \beta g
    & = \alpha \sum_{i=1}^n a_i 1_{A_i} + \beta \sum_{j=1}^m b_j 1_{B_j} \\
    & = \sum_{i,j} \left( \alpha a_i + \beta b_j \right) 1_{C_ij},
  \end{align}
  なので,\ 
  \begin{align}
    \mu(\alpha f + \beta g)
    & = \sum_{i,j} \left( \alpha a_i + \beta b_j\right) \mu(C_{ij}) \\
    & = \alpha \sum_{i=1}^n a_i \sum_{j=1}^m \mu(C_{ij}) + \beta \sum_{j=1}^m b_j \sum_{i=1}^n \mu(C_{ij}) \\
    & = \alpha \sum_{i=1}^n a_i \mu(A_i) + \beta \sum_{j=1}^m \mu(B_j) \\
    & = \alpha \mu(f) + \beta \mu(g).
  \end{align}

  (2)
  $I := \left\{(i,j) | C_{ij} \neq \emptyset \right\}$
  とすると,\ 
  \begin{align}
    g- f
    & = \sum_{i,j} (b_j - a_i) 1_{C_{ij}} \\
    & = \sum_{(i,j) \in I} (b_j - a_i) 1_{C_{ij}} \geq 0,
  \end{align}
  であるので,\ 
  $(i,j) \in I$
  ならば,\ 
  $b_j - a_i \geq 0$
  である.\ 
  よって,\ 
  $\mu(g-f) = \sum_{(i,j) \in I} (b_j-a_i) \mu(C_{ij}) \geq 0$
  であるので,\ 線形性より
  $\mu(f) \leq \mu(g)$.
\end{proof}

\section*{単調収束定理}
単調収束定理は測度論の中でも重要な定理で,\ 単純な関数で示せる性質を非負値関数,\ そして一般の可測関数に拡張するためや,\ Fatouの補題,\ Lebesugueの収束定理を示す際に使われる定理である.\ 
単調収束定理を証明するためにいくつかの命題,\ 補題を証明する.\ 

\begin{proposition}\label{prop:doubly}
  $\forall r, n \in \mathbb{N}$
  に対して,\ 
  $y_n^r \in \left[ 0,\infty \right]$
  であり,\ かつ次の2つを満たすとする.\ 
  \begin{itemize}
    \item 
      $y_n^r$
      が
      $r$
      を固定した時,\ 
      $n$
      について単調増加で,\ 
      $y^r:=\lim_n y_n^r$
      が存在する.\ 
    \item
      $y_n^r$
      が
      $n$
      を固定した時,\ 
      $r$
      について単調増加で,\ 
      $y_n:=\lim_r y_n^r$
      が存在する.\ 
  \end{itemize}
  このとき,\ 
  $y^\infty:=\lim_r y^r = \lim_n y_n=:y_\infty$
  となる.\ 
\end{proposition}

\begin{proof}
  任意の
  $\epsilon > 0$
  に対し,\ 
  $y_{n_0} > y_\infty - \frac{1}{2}\epsilon$
  となる
  $n_0 \in \mathbb{N}$
  が存在する.\ 
  また,\ 
  $y_{n_0}^{r_0} > y_{n_0} - \frac{1}{2}\epsilon$
  となる
  $r_0 \in \mathbb{N}$
  が存在する.\ 
  よって,\ 
  $y^{\infty} \geq y^{r_0} \geq y_{n_0}^{r_0} > y_{n_0} - \frac{1}{2} > y_{\infty} - \epsilon$
  となり,\ 
  $y^{\infty} \geq y_{\infty}$
  であることがわかる.\ 
  同様に,\ 
  $y_{\infty} \geq y^{\infty}$
  なので,\ 
  $y^{\infty} = y_{\infty}$
  が得られた.\ 
\end{proof}


\begin{lemma} \label{lemma:mono_set}
  $F_n \in \mathcal{F}$
  が
  $F_n \nearrow F$
  とする.\ 
  このとき,\ 
  $\lim_{n} \mu(F_n) = \mu(F)$
  となる.\ 
\end{lemma}


\begin{proof}
  $G_1 = F_1$,\ 
  $G_n = F_n \setminus F_{n-1}\ (n\geq2)$
  とすると,\ 各
  $G_n$
  はそれぞれ互いに素である.\ 
  よって,\ 
  $\mu(F_n) = \mu(\bigcup_{k=1}^n G_k) = \sum_{k=1}^n \mu(G_k)$
  であるので,\ 
  $\lim_{n} \mu(F_n) = \lim_n \mu\left( \bigcup_{k=1}^n G_k\right) = \lim_n \sum_{k=1}^n \mu(G_k)  = \sum_{k=1}^{\infty} \mu(G_k) = \mu\left( \bigcup_{k=1}^{\infty} G_k\right) = \mu\left( \bigcup_{n=1}^{\infty}F_n\right) = \mu(F)$.
\end{proof}

\begin{lemma}\label{lemma:point_convergence}
  (1)
  $A \in \mathcal{F},\ h_n \in SF^+$,\ 
  $h_n \nearrow 1_A$
  とする.\ 
  このとき,\ 
  $\lim_n \mu(h_n) = \mu(A)$
  である.\ 

  (2)
  $f,\ g_n \in SF^+$
  で,\ 
  $g_n \nearrow f$
  とする.\ 
  このとき,\ 
  $\lim_n \mu(g_n) = \mu(f)$
  である.\ 
\end{lemma}

\begin{proof}
  (1)
  補題\ref{lemma:int_nature}(2)より,\ 
  $\mu(h_n) \leq \mu(1_A) = \mu(A)$
  である.\ 
  よって,\ 
  $\liminf_{n} \mu(h_n) \geq \mu(A)$
  を示せば十分である.\ 

  $\epsilon > 0$
  とし,\ 
  $A_n := \left\{\omega \in A | h_n(\omega) > 1-\epsilon \right\}$
  とする.\ 
  $\omega \in A$
  であるとき,\ 
  $h_n$
  は
  $1_{A}$
  に各点収束するから,\ 
  $h_{n_0}(\omega) > 1 - \epsilon$
  となるような
  $n_0 \in \mathbb{N}$
  が存在するので,\ 
  $\omega \in \bigcup_{n=1}^{\infty} A_n$
  となり,\ 
  $A \subset \bigcup_{n=1}^{\infty} A_n$.\ 
  よって,\ 
  $A = \bigcup_{n=1}^{\infty} A_n$
  なので,\ 
  $A_n \nearrow A$
  である.\ 
  補題\ref{lemma:mono_set}より,\ 
  $\lim_n \mu(A_n) = \mu(A)$
  となる.\ 

  また,\ 
  $A_n$
  の定義から,\ 
  $(1-\epsilon)1_{A_n} \leq h_n$
  であるので,\ 補題\ref{lemma:int_nature}より,\ 
  $\mu((1-\epsilon)1_{A_n}) = (1-\epsilon)\mu(A_n) \leq \mu(h_n)$
  となり,\ 
  $\liminf_n \mu(h_n) \geq (1-\epsilon) \mu(A)$
  である.\ 
  $\epsilon>0$
  は任意にとってよいので
  $\liminf_n \mu(h_n) \geq \mu(A)$
  となる.\ 

  (2)
  $f = \sum_{i=1}^m a_i 1_{A_i}$
  とし,\ 
  各
  $A_i$
  は互いに素で,\ 
  $a_i \geq 0$
  とする.\ 
  このとき,\ 各
  $i$
  で,\ 
  $g_n \nearrow f$
  であるので,\ 
  $1_{A_i}g_n \nearrow 1_{A_i}f = a_i 1_{A_i}$
  となり,\ 
  $a_i^{-1}1_{A_i}g_n \nearrow 1_{A_i}$
  となる.\ 
  よって,\ 積分の線形性と(1)とより,\ 
  $\lim_n \mu(a_i^{-1}1_{A_i}g_n) = a_i^{-1} \lim_n \mu(1_{A_i}g_n) = \mu(A_i)$
  から,\ 
  $\lim_n \mu(1_{A_i}g_n) = a_i \mu(A_i)$
  となる.\ 
  また,\ 
  $g_n = \sum_{i=1}^m 1_{A_i}g_n$
  と表現できる.\ 
  したがって,\ 
  \begin{align}
    \lim_n \mu(g_n)
    & = \lim_{n \to \infty} \mu\left(\sum_{i=1}^m 1_{A_i}g_n \right) \\
    & = \lim_{n \to \infty} \sum_{i=1}^m \mu(1_{A_i}g_n) \\
    & = \sum_{i=1}^m \lim_{n \to \infty} \mu(1_{A_i}g_n) \\
    & = \sum_{i=1}^m a_i \mu(A_i) \\
    & = \mu(f).
  \end{align}
\end{proof}

\begin{lemma}[積分の唯一性]\label{lemma:int_unique}
  \mbox{}
  (1)
  $f \in m\mathcal{F}^+$
  とし,\ 
  二つの関数列
  $f^r,\ f_n \in SF^+$
  が各々
  $f^r \nearrow f,\ f_n \nearrow f$
  とする.\ 
  このとき,\ 
  $\lim_r \mu\left( f^r\right) = \lim_n \mu\left( f_n\right)$
  である.\ 

  (2)
  $f \in m\mathcal{F}^+$
  とし,\ 関数列
  $f_n \in SF^+$
  が
  $f_n \nearrow f$
  であるとする.\ 
  このとき,\ 
  $\lim_n \mu(f_n) = \mu(f)$
  である.\ 
\end{lemma}

\begin{proof}
  (1)
  $f_n^r:\Omega \to \mathbb{R} : \omega \mapsto \min\left( f^r(\omega), f_n(\omega)\right)$
  とする.\ 
  このとき,\ 
  $r$
  に関して
  $f_n^r\nearrow f_n$
  ,
  $n$
  に関して
  $f_n^r \nearrow f^r$
  となる.\ 
  補題\ref{lemma:point_convergence}(2)より,\ 
  $\lim_r \mu\left( f_n^r\right) = \mu(f_n)$,
  $\lim_n \mu\left( f_n^r\right) = \mu(f^r)$
  となり,\ 命題\ref{prop:doubly}から,\ 
  $\lim_r \mu\left( f^r\right) = \lim_n \mu\left( f_n\right)$
  である.\ 

  (2)
  非負値関数の定義より,\ 各点で
  $h_n < f $
  で
  $\lim_n \mu(h_n) = \mu(f)$
  となるような関数列
  $h_n \in SF^+$
  が存在する.\ 
  関数列
  $g_n \in SF^+$
  が
  $g_n \nearrow f$
  であるとする.\ 
  ここで,\ 
  $f'_n := \max(g_n,\ h_1,\ h_2,\ \ldots,\ h_n)$
  とすると,\ 
  $f'_n \in SF^+,\ f'_n \leq f$
  となり,\ 
  $f'_n \geq g$
  であるので,\ 
  $f'_n \nearrow f$
  である.\ 
  積分の定義から,\ 
  $\mu(f'_n) \leq \mu(f)$
  である.\ 
  さらに,\ 
  $f'_n \geq h_n$
  であるので,\ 
  $\mu(f'_n) \geq \mu(h_n)$
  である.\ 
  よって,\ 
  $\mu(f) = \lim_n \mu(h_n) \leq \lim_n \mu(f'_n)$
  となり,\ 
  $\lim_n \mu(f'_n) = \mu(f)$
  であることがわかった.\ 

  関数列
  $f_n\in SF^+$
  が
  $f_n \nearrow f$
  となるように任意に選んできたとき,\ (1)より,\ 
  $\lim_n \mu(f_n) = \lim_n \mu(f'_n) = \mu(f)$
  となる.\ 
\end{proof}

教科書の期待値の定義はこの補題のことを言っている.\ 

\begin{theorem}[単調収束定理]\label{theo:mono}
  $f_n \in m\mathcal{F}^+,\ f_n \nearrow f \ (\in m\mathcal{F}^+\footnote{可測関数の極限は可測関数である.\ })$
  とする.\ 
  このとき,\ 
  $\lim_n \mu(f_n) = \mu(f)$
  となる.\ 
\end{theorem}

\begin{proof}
  任意の
  $r \in \mathbb{N}$
  に対して、
  \begin{equation}
    \alpha^r:\left[ 0,\infty\right] \to \left[ 0,\infty\right]:x\mapsto
    \begin{cases}
      0 & {\rm if}\ x=0 \\
      (i-1)2^{-r} & {\rm if}\ (i-1)2^{-r} < x \leq i2^{-r} \ (i\in\mathbb{N}) \\
      r & {\rm if} \ x > r,
    \end{cases}
  \end{equation}
  とする.\ 
  $f_n^r:=\alpha^r \circ f_n,\ f^r:=\alpha^r \circ f$
  とする.\ 
  明らかに
  $f_n^r,\ f^r \in SF^+$
  である.\ 
  $\alpha^r$
  は左連続関数で,\ 
  $f_n \nearrow f$
  だから,\ 
  $f_n^r \nearrow f^r$
  となるので,\ 補題\ref{lemma:point_convergence}(2)より,\ 
  $\lim_n \mu(f_n^r) = \mu(f^r)$
  である.\ 
  また,\ 
  $id:[0,\infty) \to [0,\infty)$
  を恒等写像とすると,\ 
  $a_r \nearrow id$\footnote{
    任意の
    $x\in \left[ 0, \infty \right)$
    ,\ 
    $\epsilon > 0$
    に対して,\ 
    $r_0 = \lceil \max(x, -\log_2 \epsilon) \rceil$
    とする.\ 
    $r > r_0$
    とする.\ 
    $x \leq r_0 < r$
    だから,\ ある
    $i \in \mathbb{N}$
    が存在して
    $(i-1)2^{-r} < x \leq i2^{-r}$
    とできる.\ 
    よって,\ 
    $i \geq x2^r$
    であるので,\ 
    $0 < x - \alpha^r(x) = x - (i-1)2^{-r} \leq x - (x2^r - 1)2^{-r} = 2^{-r}$
    となる.\ 
    $- \log_2 \epsilon < r$
    だから,\ 
    $2^{-r} < \epsilon$
    となる.\ 
    したがって,\ 
    $0 < x- \alpha^r(x) < \epsilon$
    を示すことができたので,\ 
    $\alpha^r \nearrow id$.
  }
  だから,\ 
  $f_n^r \nearrow f_n$
  となり,\ 補題\ref{lemma:int_unique}(2)より,\ 
  $\lim_r \mu(f_n^r) = \mu(f_n)$
  である.\ 
  さらに,\ 
  $f^r \nearrow f$
  であるので,\ 補題\ref{lemma:int_unique}(2)より,\ 
  $\lim_r \mu(f^r) = \mu(f)$
  である.\ 
  以上より,\ 命題\ref{prop:doubly}より,\ 
  $\lim_n \mu(f_n) = \lim_r \mu(f^r) = \mu(f)$
  とわかる.\ 
\end{proof}

\section*{測度論の積分における主要な定理}
以下、単調収束定理を用いて、Fatouの補題、Lebesugueの収束定理を示す。

\begin{lemma}[Fatouの補題]\label{lemma:Fatou}
\end{lemma}


%\bibliographystyle{junsrt}
%\bibliography{}

\end{document}
